SELECT PREP.PCO_OUTBOUNDQUEUE.SOURCEID,
PREP.PCO_OUTBOUNDQUEUE.ID,
PREP.PCO_OUTBOUNDQUEUE.SERVICEID,
PREP.PCO_OUTBOUNDSERVICE.NAME AS SERVICENAME,
PREP.PCO_OUTBOUNDQUEUE.NAME,
PREP.PCO_OUTBOUNDQUEUE.PHONE,
dbo.StatusCodes.DESCRIPTION AS STATUSDESCR,
PREP.PCO_OUTBOUNDQUEUE.SCHEDULEDATE,
PREP.PCO_OUTBOUNDQUEUE.LOADID,
PREP.PCO_LOAD.DESCRIPTION AS LOADDESCRIPTION,
PREP.PCO_OUTBOUNDQUEUE.LASTAGENT,
PREP.PCO_AGENT.NAME AS AGENTNAME,
CASE 
WHEN dbo.OutboundQCodeByServiceID.CATEGORY IS NULL AND LASTQCODE IS NOT NULL THEN 'INVALID' 
WHEN dbo.OutboundQCodeByServiceID.CATEGORY IS NULL AND LASTQCODE IS NULL THEN NULL
ELSE dbo.OutboundQCodeByServiceID.CATEGORY
END AS LASTQCODECATEGORY, PREP.PCO_OUTBOUNDQUEUE.LASTQCODE,
CASE WHEN LASTQCODE = 0 THEN 'Cancelled by agent' 
WHEN LASTQCODE = 1 THEN 'No answer' 
WHEN LASTQCODE = 2 THEN 'Busy signal' 
WHEN LASTQCODE = 4 THEN 'Answering machine' 
WHEN LASTQCODE = 5 THEN 'Fax' 
WHEN LASTQCODE = 6 THEN 'Abandoned call' 
WHEN LASTQCODE = 9 THEN 'Customer hangs up' 
WHEN LASTQCODE = 20 THEN 'Invalid generic reason' 
WHEN LASTQCODE = 21 THEN 'CTI error' 
WHEN LASTQCODE = 80 THEN 'Busy signal - Agent' 
WHEN LASTQCODE = 81 THEN 'No answer - Agent' 
WHEN LASTQCODE = 82 THEN 'Answering machine - Agent'
WHEN LASTQCODE = 83 THEN 'Fax - Agent'
WHEN LASTQCODE = 84 THEN 'Dropped call' 
WHEN LASTQCODE = 85 THEN 'Phone number does not ex' 
WHEN LASTQCODE = 90 THEN 'Scheduled' 
WHEN LASTQCODE = 91 THEN 'Scheduled to another phone number' 
WHEN LASTQCODE = 92 THEN 'Contact phone numbers do not exist' 
WHEN LASTQCODE = 93 THEN 'Wrong contact phone numbers' 
WHEN LASTQCODE = 94 THEN 'Wrong address' 
WHEN LASTQCODE = 95 THEN 'Unreachable during calling hours' 
WHEN LASTQCODE = 96 THEN 'Deceased' 
WHEN LASTQCODE = 97 THEN 'Incomplete' 
WHEN LASTQCODE = 98 THEN 'Do not call again'
WHEN LASTQCODE = 100 THEN 'Disconnected Number'
WHEN LASTQCODE = 101 THEN 'Declined Sale'
WHEN LASTQCODE = 102 THEN 'No Pitch No Price'
WHEN LASTQCODE = 103 THEN 'Busy Auto'
WHEN LASTQCODE = 104 THEN 'Disconnected Number Temporary'
WHEN LASTQCODE = 105 THEN 'Disconnected Number Auto'
WHEN LASTQCODE = 106 THEN 'DM Already Contacted'
WHEN LASTQCODE = 107 THEN 'OIP - Waiting Docs'
WHEN LASTQCODE = 108 THEN 'OIP - Waiting Installation'
WHEN LASTQCODE = 109 THEN 'OIP - Waiting Delivery'
WHEN LASTQCODE = 110 THEN 'Call Back Agent Owned'
WHEN LASTQCODE = 111 THEN 'Retry - Call Dropped'
WHEN LASTQCODE = 112 THEN 'Retry - DM Hung Up'
WHEN LASTQCODE = 113 THEN 'Invalid Number - Does Not Exist'
WHEN LASTQCODE = 114 THEN 'DM Not Available'
WHEN LASTQCODE = 115 THEN 'Retry - Voice Mail'
WHEN LASTQCODE = 116 THEN 'OIP - Waiting Vetting'
WHEN LASTQCODE = 117 THEN 'Sale Made'
WHEN LASTQCODE = 118 THEN 'Call Transferred'
WHEN LASTQCODE = 119 THEN 'Sale - Fibre'
WHEN LASTQCODE = 120 THEN 'Sale - LTE'
WHEN LASTQCODE = 121 THEN 'Sale - DSL'
WHEN LASTQCODE = 122 THEN 'Sale - SIM Only'
WHEN LASTQCODE = 123 THEN 'Do Not Call'
WHEN LASTQCODE = 124 THEN 'Not Interested'
WHEN LASTQCODE = 125 THEN 'NSO - Cannot Afford'
WHEN LASTQCODE = 126 THEN 'NI - Customer With Competitor'
WHEN LASTQCODE = 127 THEN 'NSO - DM Unemployed'
WHEN LASTQCODE = 128 THEN 'NI - Existing Customer'
WHEN LASTQCODE = 129 THEN 'NI - Existing To Fibre'
WHEN LASTQCODE = 130 THEN 'NI - Existing To LTE'
WHEN LASTQCODE = 131 THEN 'NI - Product Too Expensive'
WHEN LASTQCODE = 132 THEN 'Expired Lead'
WHEN LASTQCODE = 133 THEN 'NSO - Failed Debi Check Or OTP'
WHEN LASTQCODE = 134 THEN 'NSO - Failed Prevet LTE'
WHEN LASTQCODE = 135 THEN 'NI - In Contract With Other ISP'
WHEN LASTQCODE = 136 THEN 'NSO - No Fibre Coverage'
WHEN LASTQCODE = 137 THEN 'NSO - Does Not Want Too Activate DO'
WHEN LASTQCODE = 138 THEN 'NSO - No LTE Coverage'
WHEN LASTQCODE = 139 THEN 'NSO - Old Age Cannot Understand'
WHEN LASTQCODE = 140 THEN 'NSO - Customer Using Passport'
WHEN LASTQCODE = 141 THEN 'NSO - Technical Support'
WHEN LASTQCODE = 142 THEN 'NI - Vetting Decline'
WHEN LASTQCODE = 143 THEN 'Wrong Number'
WHEN LASTQCODE = 144 THEN 'Call Transferred'
WHEN LASTQCODE = 145 THEN 'Declined Sale'
WHEN LASTQCODE = 146 THEN 'NI - Customer has Prod Already'
WHEN LASTQCODE = 147 THEN 'Customer upgraded within six months'
WHEN LASTQCODE = 183 THEN 'Dsl '
WHEN LASTQCODE = 184 THEN 'Fibre'
WHEN LASTQCODE = 185 THEN 'Lte'
WHEN LASTQCODE = 186 THEN 'Sim Only'
WHEN LASTQCODE = 187 THEN 'Dropped Call'
WHEN LASTQCODE = 188 THEN 'Voicemail'
WHEN LASTQCODE = 189 THEN 'Awaiting Delivery '
WHEN LASTQCODE = 190 THEN 'Awaiting Installation '
WHEN LASTQCODE = 191 THEN 'Contact Number Mismatch On Lead'
WHEN LASTQCODE = 192 THEN 'Awaiting Vetting '
WHEN LASTQCODE = 193 THEN 'Failed Debi Check'
WHEN LASTQCODE = 194 THEN 'Business Customer'
WHEN LASTQCODE = 195 THEN 'Unemployed'
WHEN LASTQCODE = 196 THEN 'Customer Requested Upgrade'
WHEN LASTQCODE = 197 THEN 'Customer Cannot Afford Product'
WHEN LASTQCODE = 198 THEN 'Failed Prevet Lte'
WHEN LASTQCODE = 199 THEN 'Failed OTP'
WHEN LASTQCODE = 200 THEN 'No Lte Coverage'
WHEN LASTQCODE = 201 THEN 'Unresolved Dispute'
WHEN LASTQCODE = 202 THEN 'Order In Progress'
WHEN LASTQCODE = 203 THEN 'Passport Customer Requesting LTE'
WHEN LASTQCODE = 204 THEN 'No Bank Account'
WHEN LASTQCODE = 205 THEN 'No Fibre Coverage '
WHEN LASTQCODE = 206 THEN 'Old Age Cannot Understand Content Or Pitch'
WHEN LASTQCODE = 207 THEN 'Does Not Want To Activate Debit Order'
WHEN LASTQCODE = 208 THEN 'Salary Criteria Not Met Below R4000'
WHEN LASTQCODE = 210 THEN 'In Contract With Other ISP'
WHEN LASTQCODE = 211 THEN 'Written Off Amount With Telkom'
WHEN LASTQCODE = 212 THEN 'Customer Does Not Want To Be Contacted'
WHEN LASTQCODE = 213 THEN 'Number Does Not Exist'
WHEN LASTQCODE = 214 THEN 'Agent Scheduled Call-back'
WHEN LASTQCODE = 215 THEN 'Busy Tone'
WHEN LASTQCODE = 216 THEN 'Language Barrier'
WHEN LASTQCODE = 217 THEN 'Telkom account in arrears'
WHEN LASTQCODE = NULL THEN 'Positive_NTFLeads'
ELSE OutboundQCodeByServiceID.DESCRIPTION END AS LASTQCODEDESCRIPTION,

--\RPC Calculation---

CASE WHEN LASTQCODE = 100 THEN 'No RPC'
WHEN LASTQCODE = 103 THEN 'No RPC'
WHEN LASTQCODE = 104 THEN 'No RPC'
WHEN LASTQCODE = 105 THEN 'No RPC'
WHEN LASTQCODE = 111 THEN 'No RPC'
WHEN LASTQCODE = 113 THEN 'No RPC'
WHEN LASTQCODE = 114 THEN 'No RPC'
WHEN LASTQCODE = 115 THEN 'No RPC'
WHEN LASTQCODE = 132 THEN 'No RPC'
WHEN LASTQCODE = 143 THEN 'No RPC'
WHEN LASTQCODE = 187 THEN 'No RPC'
WHEN LASTQCODE = 188 THEN 'No RPC'
WHEN LASTQCODE = 191 THEN 'No RPC'
WHEN LASTQCODE = 213 THEN 'No RPC'
WHEN LASTQCODE = 215 THEN 'No RPC'
WHEN LASTQCODE = 216 THEN 'No RPC'
WHEN LASTQCODE = 101 THEN 'RPC'
WHEN LASTQCODE = 102 THEN 'RPC'
WHEN LASTQCODE = 106 THEN 'RPC'
WHEN LASTQCODE = 107 THEN 'RPC'
WHEN LASTQCODE = 108 THEN 'RPC'
WHEN LASTQCODE = 109 THEN 'RPC'
WHEN LASTQCODE = 110 THEN 'RPC'
WHEN LASTQCODE = 112 THEN 'RPC'
WHEN LASTQCODE = 116 THEN 'RPC'
WHEN LASTQCODE = 117 THEN 'RPC'
WHEN LASTQCODE = 118 THEN 'RPC'
WHEN LASTQCODE = 119 THEN 'RPC'
WHEN LASTQCODE = 120 THEN 'RPC'
WHEN LASTQCODE = 121 THEN 'RPC'
WHEN LASTQCODE = 122 THEN 'RPC'
WHEN LASTQCODE = 123 THEN 'RPC'
WHEN LASTQCODE = 124 THEN 'RPC'
WHEN LASTQCODE = 125 THEN 'RPC'
WHEN LASTQCODE = 126 THEN 'RPC'
WHEN LASTQCODE = 127 THEN 'RPC'
WHEN LASTQCODE = 128 THEN 'RPC'
WHEN LASTQCODE = 129 THEN 'RPC'
WHEN LASTQCODE = 130 THEN 'RPC'
WHEN LASTQCODE = 131 THEN 'RPC'
WHEN LASTQCODE = 133 THEN 'RPC'
WHEN LASTQCODE = 134 THEN 'RPC'
WHEN LASTQCODE = 135 THEN 'RPC'
WHEN LASTQCODE = 136 THEN 'RPC'
WHEN LASTQCODE = 137 THEN 'RPC'
WHEN LASTQCODE = 138 THEN 'RPC'
WHEN LASTQCODE = 139 THEN 'RPC'
WHEN LASTQCODE = 140 THEN 'RPC'
WHEN LASTQCODE = 141 THEN 'RPC'
WHEN LASTQCODE = 142 THEN 'RPC'
WHEN LASTQCODE = 144 THEN 'RPC'
WHEN LASTQCODE = 145 THEN 'RPC'
WHEN LASTQCODE = 146 THEN 'RPC'
WHEN LASTQCODE = 147 THEN 'RPC'
WHEN LASTQCODE = 183 THEN 'RPC'
WHEN LASTQCODE = 184 THEN 'RPC'
WHEN LASTQCODE = 185 THEN 'RPC'
WHEN LASTQCODE = 186 THEN 'RPC'
WHEN LASTQCODE = 189 THEN 'RPC'
WHEN LASTQCODE = 190 THEN 'RPC'
WHEN LASTQCODE = 192 THEN 'RPC'
WHEN LASTQCODE = 193 THEN 'RPC'
WHEN LASTQCODE = 194 THEN 'RPC'
WHEN LASTQCODE = 195 THEN 'RPC'
WHEN LASTQCODE = 196 THEN 'RPC'
WHEN LASTQCODE = 197 THEN 'RPC'
WHEN LASTQCODE = 198 THEN 'RPC'
WHEN LASTQCODE = 199 THEN 'RPC'
WHEN LASTQCODE = 200 THEN 'RPC'
WHEN LASTQCODE = 201 THEN 'RPC'
WHEN LASTQCODE = 202 THEN 'RPC'
WHEN LASTQCODE = 203 THEN 'RPC'
WHEN LASTQCODE = 204 THEN 'RPC'
WHEN LASTQCODE = 205 THEN 'RPC'
WHEN LASTQCODE = 206 THEN 'RPC'
WHEN LASTQCODE = 207 THEN 'RPC'
WHEN LASTQCODE = 208 THEN 'RPC'
WHEN LASTQCODE = 210 THEN 'RPC'
WHEN LASTQCODE = 211 THEN 'RPC'
WHEN LASTQCODE = 212 THEN 'RPC'
WHEN LASTQCODE = 214 THEN 'RPC'
WHEN LASTQCODE = 217 THEN 'RPC'
WHEN LASTQCODE = 0 THEN 'No RPC'
WHEN LASTQCODE = 1 THEN 'No RPC'
WHEN LASTQCODE = 2 THEN 'No RPC'
WHEN LASTQCODE = 4 THEN 'No RPC'
WHEN LASTQCODE = 5 THEN 'No RPC'
WHEN LASTQCODE = 6 THEN 'No RPC'
WHEN LASTQCODE = 9 THEN 'No RPC'
WHEN LASTQCODE = 20 THEN 'No RPC'
WHEN LASTQCODE = 21 THEN 'No RPC'
WHEN LASTQCODE = 80 THEN 'No RPC'
WHEN LASTQCODE = 81 THEN 'No RPC'
WHEN LASTQCODE = 82 THEN 'No RPC'
WHEN LASTQCODE = 83 THEN 'No RPC'
WHEN LASTQCODE = 84 THEN 'No RPC'
WHEN LASTQCODE = 85 THEN 'No RPC'
WHEN LASTQCODE = 90 THEN 'RPC'
WHEN LASTQCODE = 91 THEN 'RPC'
WHEN LASTQCODE = 92 THEN 'No RPC'
WHEN LASTQCODE = 93 THEN 'No RPC'
WHEN LASTQCODE = 94 THEN 'RPC'
WHEN LASTQCODE = 95 THEN 'No RPC'
WHEN LASTQCODE = 96 THEN 'No RPC'
WHEN LASTQCODE = 97 THEN 'No RPC'
WHEN LASTQCODE = 98 THEN 'RPC'
ELSE OutboundQCodeByServiceID.DESCRIPTION END AS [RPC Indicator],

--Contact Calculation---

CASE WHEN LASTQCODE = 100 THEN 'No Contact'
WHEN LASTQCODE = 103 THEN 'No Contact'
WHEN LASTQCODE = 104 THEN 'No Contact'
WHEN LASTQCODE = 105 THEN 'No Contact'
WHEN LASTQCODE = 111 THEN 'No Contact'
WHEN LASTQCODE = 113 THEN 'No Contact'
WHEN LASTQCODE = 114 THEN 'Contact'
WHEN LASTQCODE = 115 THEN 'No Contact'
WHEN LASTQCODE = 132 THEN 'Contact'
WHEN LASTQCODE = 143 THEN 'Contact'
WHEN LASTQCODE = 187 THEN 'No Contact'
WHEN LASTQCODE = 188 THEN 'No Contact'
WHEN LASTQCODE = 191 THEN 'Contact'
WHEN LASTQCODE = 213 THEN 'No Contact'
WHEN LASTQCODE = 215 THEN 'No Contact'
WHEN LASTQCODE = 216 THEN 'Contact'
WHEN LASTQCODE = 101 THEN 'Contact'
WHEN LASTQCODE = 102 THEN 'Contact'
WHEN LASTQCODE = 106 THEN 'Contact'
WHEN LASTQCODE = 107 THEN 'Contact'
WHEN LASTQCODE = 108 THEN 'Contact'
WHEN LASTQCODE = 109 THEN 'Contact'
WHEN LASTQCODE = 110 THEN 'Contact'
WHEN LASTQCODE = 112 THEN 'Contact'
WHEN LASTQCODE = 116 THEN 'Contact'
WHEN LASTQCODE = 117 THEN 'Contact'
WHEN LASTQCODE = 118 THEN 'Contact'
WHEN LASTQCODE = 119 THEN 'Contact'
WHEN LASTQCODE = 120 THEN 'Contact'
WHEN LASTQCODE = 121 THEN 'Contact'
WHEN LASTQCODE = 122 THEN 'Contact'
WHEN LASTQCODE = 123 THEN 'Contact'
WHEN LASTQCODE = 124 THEN 'Contact'
WHEN LASTQCODE = 125 THEN 'Contact'
WHEN LASTQCODE = 126 THEN 'Contact'
WHEN LASTQCODE = 127 THEN 'Contact'
WHEN LASTQCODE = 128 THEN 'Contact'
WHEN LASTQCODE = 129 THEN 'Contact'
WHEN LASTQCODE = 130 THEN 'Contact'
WHEN LASTQCODE = 131 THEN 'Contact'
WHEN LASTQCODE = 133 THEN 'Contact'
WHEN LASTQCODE = 134 THEN 'Contact'
WHEN LASTQCODE = 135 THEN 'Contact'
WHEN LASTQCODE = 136 THEN 'Contact'
WHEN LASTQCODE = 137 THEN 'Contact'
WHEN LASTQCODE = 138 THEN 'Contact'
WHEN LASTQCODE = 139 THEN 'Contact'
WHEN LASTQCODE = 140 THEN 'Contact'
WHEN LASTQCODE = 141 THEN 'Contact'
WHEN LASTQCODE = 142 THEN 'Contact'
WHEN LASTQCODE = 144 THEN 'Contact'
WHEN LASTQCODE = 145 THEN 'Contact'
WHEN LASTQCODE = 146 THEN 'Contact'
WHEN LASTQCODE = 147 THEN 'Contact'
WHEN LASTQCODE = 183 THEN 'Contact'
WHEN LASTQCODE = 184 THEN 'Contact'
WHEN LASTQCODE = 185 THEN 'Contact'
WHEN LASTQCODE = 186 THEN 'Contact'
WHEN LASTQCODE = 189 THEN 'Contact'
WHEN LASTQCODE = 190 THEN 'Contact'
WHEN LASTQCODE = 192 THEN 'Contact'
WHEN LASTQCODE = 193 THEN 'Contact'
WHEN LASTQCODE = 194 THEN 'Contact'
WHEN LASTQCODE = 195 THEN 'Contact'
WHEN LASTQCODE = 196 THEN 'Contact'
WHEN LASTQCODE = 197 THEN 'Contact'
WHEN LASTQCODE = 198 THEN 'Contact'
WHEN LASTQCODE = 199 THEN 'Contact'
WHEN LASTQCODE = 200 THEN 'Contact'
WHEN LASTQCODE = 201 THEN 'Contact'
WHEN LASTQCODE = 202 THEN 'Contact'
WHEN LASTQCODE = 203 THEN 'Contact'
WHEN LASTQCODE = 204 THEN 'Contact'
WHEN LASTQCODE = 205 THEN 'Contact'
WHEN LASTQCODE = 206 THEN 'Contact'
WHEN LASTQCODE = 207 THEN 'Contact'
WHEN LASTQCODE = 208 THEN 'Contact'
WHEN LASTQCODE = 210 THEN 'Contact'
WHEN LASTQCODE = 211 THEN 'Contact'
WHEN LASTQCODE = 212 THEN 'Contact'
WHEN LASTQCODE = 214 THEN 'Contact'
WHEN LASTQCODE = 217 THEN 'Contact'
WHEN LASTQCODE = 0 THEN 'No Contact'
WHEN LASTQCODE = 1 THEN 'No Contact'
WHEN LASTQCODE = 2 THEN 'No Contact'
WHEN LASTQCODE = 4 THEN 'No Contact'
WHEN LASTQCODE = 5 THEN 'No Contact'
WHEN LASTQCODE = 6 THEN 'No Contact'
WHEN LASTQCODE = 9 THEN 'Contact'
WHEN LASTQCODE = 20 THEN 'No Contact'
WHEN LASTQCODE = 21 THEN 'No Contact'
WHEN LASTQCODE = 80 THEN 'No Contact'
WHEN LASTQCODE = 81 THEN 'No Contact'
WHEN LASTQCODE = 82 THEN 'No Contact'
WHEN LASTQCODE = 83 THEN 'No Contact'
WHEN LASTQCODE = 84 THEN 'No Contact'
WHEN LASTQCODE = 85 THEN 'No Contact'
WHEN LASTQCODE = 90 THEN 'Contact'
WHEN LASTQCODE = 91 THEN 'Contact'
WHEN LASTQCODE = 92 THEN 'Contact'
WHEN LASTQCODE = 93 THEN 'Contact'
WHEN LASTQCODE = 94 THEN 'Contact'
WHEN LASTQCODE = 95 THEN 'No Contact'
WHEN LASTQCODE = 96 THEN 'Contact'
WHEN LASTQCODE = 97 THEN 'No Contact'
WHEN LASTQCODE = 98 THEN 'Contact'
ELSE OutboundQCodeByServiceID.DESCRIPTION END AS [Contact Indicator],

-------------\\ Add in RPC Indicator with Int Datatype //----------------------------------

CASE WHEN Convert(Int,LASTQCODE) = 100 THEN '0'
WHEN Convert(Int,LASTQCODE) = 103 THEN '0'
WHEN Convert(Int,LASTQCODE) = 104 THEN '0'
WHEN Convert(Int,LASTQCODE) = 105 THEN '0'
WHEN Convert(Int,LASTQCODE) = 111 THEN '0'
WHEN Convert(Int,LASTQCODE) = 113 THEN '0'
WHEN Convert(Int,LASTQCODE) = 114 THEN '0'
WHEN Convert(Int,LASTQCODE) = 115 THEN '0'
WHEN Convert(Int,LASTQCODE) = 132 THEN '0'
WHEN Convert(Int,LASTQCODE) = 143 THEN '0'
WHEN Convert(Int,LASTQCODE) = 187 THEN '0'
WHEN Convert(Int,LASTQCODE) = 188 THEN '0'
WHEN Convert(Int,LASTQCODE) = 191 THEN '0'
WHEN Convert(Int,LASTQCODE) = 213 THEN '0'
WHEN Convert(Int,LASTQCODE) = 215 THEN '0'
WHEN Convert(Int,LASTQCODE) = 216 THEN '0'
WHEN Convert(Int,LASTQCODE) = 101 THEN '1'
WHEN Convert(Int,LASTQCODE) = 102 THEN '1'
WHEN Convert(Int,LASTQCODE) = 106 THEN '1'
WHEN Convert(Int,LASTQCODE) = 107 THEN '1'
WHEN Convert(Int,LASTQCODE) = 108 THEN '1'
WHEN Convert(Int,LASTQCODE) = 109 THEN '1'
WHEN Convert(Int,LASTQCODE) = 110 THEN '1'
WHEN Convert(Int,LASTQCODE) = 112 THEN '1'
WHEN Convert(Int,LASTQCODE) = 116 THEN '1'
WHEN Convert(Int,LASTQCODE) = 117 THEN '1'
WHEN Convert(Int,LASTQCODE) = 118 THEN '1'
WHEN Convert(Int,LASTQCODE) = 119 THEN '1'
WHEN Convert(Int,LASTQCODE) = 120 THEN '1'
WHEN Convert(Int,LASTQCODE) = 121 THEN '1'
WHEN Convert(Int,LASTQCODE) = 122 THEN '1'
WHEN Convert(Int,LASTQCODE) = 123 THEN '1'
WHEN Convert(Int,LASTQCODE) = 124 THEN '1'
WHEN Convert(Int,LASTQCODE) = 125 THEN '1'
WHEN Convert(Int,LASTQCODE) = 126 THEN '1'
WHEN Convert(Int,LASTQCODE) = 127 THEN '1'
WHEN Convert(Int,LASTQCODE) = 128 THEN '1'
WHEN Convert(Int,LASTQCODE) = 129 THEN '1'
WHEN Convert(Int,LASTQCODE) = 130 THEN '1'
WHEN Convert(Int,LASTQCODE) = 131 THEN '1'
WHEN Convert(Int,LASTQCODE) = 133 THEN '1'
WHEN Convert(Int,LASTQCODE) = 134 THEN '1'
WHEN Convert(Int,LASTQCODE) = 135 THEN '1'
WHEN Convert(Int,LASTQCODE) = 136 THEN '1'
WHEN Convert(Int,LASTQCODE) = 137 THEN '1'
WHEN Convert(Int,LASTQCODE) = 138 THEN '1'
WHEN Convert(Int,LASTQCODE) = 139 THEN '1'
WHEN Convert(Int,LASTQCODE) = 140 THEN '1'
WHEN Convert(Int,LASTQCODE) = 141 THEN '1'
WHEN Convert(Int,LASTQCODE) = 142 THEN '1'
WHEN Convert(Int,LASTQCODE) = 144 THEN '1'
WHEN Convert(Int,LASTQCODE) = 145 THEN '1'
WHEN Convert(Int,LASTQCODE) = 146 THEN '1'
WHEN Convert(Int,LASTQCODE) = 147 THEN '1'
WHEN Convert(Int,LASTQCODE) = 183 THEN '1'
WHEN Convert(Int,LASTQCODE) = 184 THEN '1'
WHEN Convert(Int,LASTQCODE) = 185 THEN '1'
WHEN Convert(Int,LASTQCODE) = 186 THEN '1'
WHEN Convert(Int,LASTQCODE) = 189 THEN '1'
WHEN Convert(Int,LASTQCODE) = 190 THEN '1'
WHEN Convert(Int,LASTQCODE) = 192 THEN '1'
WHEN Convert(Int,LASTQCODE) = 193 THEN '1'
WHEN Convert(Int,LASTQCODE) = 194 THEN '1'
WHEN Convert(Int,LASTQCODE) = 195 THEN '1'
WHEN Convert(Int,LASTQCODE) = 196 THEN '1'
WHEN Convert(Int,LASTQCODE) = 197 THEN '1'
WHEN Convert(Int,LASTQCODE) = 198 THEN '1'
WHEN Convert(Int,LASTQCODE) = 199 THEN '1'
WHEN Convert(Int,LASTQCODE) = 200 THEN '1'
WHEN Convert(Int,LASTQCODE) = 201 THEN '1'
WHEN Convert(Int,LASTQCODE) = 202 THEN '1'
WHEN Convert(Int,LASTQCODE) = 203 THEN '1'
WHEN Convert(Int,LASTQCODE) = 204 THEN '1'
WHEN Convert(Int,LASTQCODE) = 205 THEN '1'
WHEN Convert(Int,LASTQCODE) = 206 THEN '1'
WHEN Convert(Int,LASTQCODE) = 207 THEN '1'
WHEN Convert(Int,LASTQCODE) = 208 THEN '1'
WHEN Convert(Int,LASTQCODE) = 210 THEN '1'
WHEN Convert(Int,LASTQCODE) = 211 THEN '1'
WHEN Convert(Int,LASTQCODE) = 212 THEN '1'
WHEN Convert(Int,LASTQCODE) = 214 THEN '1'
WHEN Convert(Int,LASTQCODE) = 217 THEN '1'
WHEN Convert(Int,LASTQCODE) = 0 THEN '0'
WHEN Convert(Int,LASTQCODE) = 1 THEN '0'
WHEN Convert(Int,LASTQCODE) = 2 THEN '0'
WHEN Convert(Int,LASTQCODE) = 4 THEN '0'
WHEN Convert(Int,LASTQCODE) = 5 THEN '0'
WHEN Convert(Int,LASTQCODE) = 6 THEN '0'
WHEN Convert(Int,LASTQCODE) = 9 THEN '0'
WHEN Convert(Int,LASTQCODE) = 20 THEN '0'
WHEN Convert(Int,LASTQCODE) = 21 THEN '0'
WHEN Convert(Int,LASTQCODE) = 80 THEN '0'
WHEN Convert(Int,LASTQCODE) = 81 THEN '0'
WHEN Convert(Int,LASTQCODE) = 82 THEN '0'
WHEN Convert(Int,LASTQCODE) = 83 THEN '0'
WHEN Convert(Int,LASTQCODE) = 84 THEN '0'
WHEN Convert(Int,LASTQCODE) = 85 THEN '0'
WHEN Convert(Int,LASTQCODE) = 90 THEN '1'
WHEN Convert(Int,LASTQCODE) = 91 THEN '1'
WHEN Convert(Int,LASTQCODE) = 92 THEN '0'
WHEN Convert(Int,LASTQCODE) = 93 THEN '0'
WHEN Convert(Int,LASTQCODE) = 94 THEN '1'
WHEN Convert(Int,LASTQCODE) = 95 THEN '0'
WHEN Convert(Int,LASTQCODE) = 96 THEN '0'
WHEN Convert(Int,LASTQCODE) = 97 THEN '0'
WHEN Convert(Int,LASTQCODE) = 98 THEN '1'
ELSE OutboundQCodeByServiceID.DESCRIPTION END AS [RPC Indicator_1],

--Contact Calculation---

CASE WHEN Convert(Int,LASTQCODE) = 100 THEN '0'
WHEN Convert(Int,LASTQCODE) = 103 THEN '0'
WHEN Convert(Int,LASTQCODE) = 104 THEN '0'
WHEN Convert(Int,LASTQCODE) = 105 THEN '0'
WHEN Convert(Int,LASTQCODE) = 111 THEN '0'
WHEN Convert(Int,LASTQCODE) = 113 THEN '0'
WHEN Convert(Int,LASTQCODE) = 114 THEN '1'
WHEN Convert(Int,LASTQCODE) = 115 THEN '0'
WHEN Convert(Int,LASTQCODE) = 132 THEN '1'
WHEN Convert(Int,LASTQCODE) = 143 THEN '1'
WHEN Convert(Int,LASTQCODE) = 187 THEN '0'
WHEN Convert(Int,LASTQCODE) = 188 THEN '0'
WHEN Convert(Int,LASTQCODE) = 191 THEN '1'
WHEN Convert(Int,LASTQCODE) = 213 THEN '0'
WHEN Convert(Int,LASTQCODE) = 215 THEN '0'
WHEN Convert(Int,LASTQCODE) = 216 THEN '1'
WHEN Convert(Int,LASTQCODE) = 101 THEN '1'
WHEN Convert(Int,LASTQCODE) = 102 THEN '1'
WHEN Convert(Int,LASTQCODE) = 106 THEN '1'
WHEN Convert(Int,LASTQCODE) = 107 THEN '1'
WHEN Convert(Int,LASTQCODE) = 108 THEN '1'
WHEN Convert(Int,LASTQCODE) = 109 THEN '1'
WHEN Convert(Int,LASTQCODE) = 110 THEN '1'
WHEN Convert(Int,LASTQCODE) = 112 THEN '1'
WHEN Convert(Int,LASTQCODE) = 116 THEN '1'
WHEN Convert(Int,LASTQCODE) = 117 THEN '1'
WHEN Convert(Int,LASTQCODE) = 118 THEN '1'
WHEN Convert(Int,LASTQCODE) = 119 THEN '1'
WHEN Convert(Int,LASTQCODE) = 120 THEN '1'
WHEN Convert(Int,LASTQCODE) = 121 THEN '1'
WHEN Convert(Int,LASTQCODE) = 122 THEN '1'
WHEN Convert(Int,LASTQCODE) = 123 THEN '1'
WHEN Convert(Int,LASTQCODE) = 124 THEN '1'
WHEN Convert(Int,LASTQCODE) = 125 THEN '1'
WHEN Convert(Int,LASTQCODE) = 126 THEN '1'
WHEN Convert(Int,LASTQCODE) = 127 THEN '1'
WHEN Convert(Int,LASTQCODE) = 128 THEN '1'
WHEN Convert(Int,LASTQCODE) = 129 THEN '1'
WHEN Convert(Int,LASTQCODE) = 130 THEN '1'
WHEN Convert(Int,LASTQCODE) = 131 THEN '1'
WHEN Convert(Int,LASTQCODE) = 133 THEN '1'
WHEN Convert(Int,LASTQCODE) = 134 THEN '1'
WHEN Convert(Int,LASTQCODE) = 135 THEN '1'
WHEN Convert(Int,LASTQCODE) = 136 THEN '1'
WHEN Convert(Int,LASTQCODE) = 137 THEN '1'
WHEN Convert(Int,LASTQCODE) = 138 THEN '1'
WHEN Convert(Int,LASTQCODE) = 139 THEN '1'
WHEN Convert(Int,LASTQCODE) = 140 THEN '1'
WHEN Convert(Int,LASTQCODE) = 141 THEN '1'
WHEN Convert(Int,LASTQCODE) = 142 THEN '1'
WHEN Convert(Int,LASTQCODE) = 144 THEN '1'
WHEN Convert(Int,LASTQCODE) = 145 THEN '1'
WHEN Convert(Int,LASTQCODE) = 146 THEN '1'
WHEN Convert(Int,LASTQCODE) = 147 THEN '1'
WHEN Convert(Int,LASTQCODE) = 183 THEN '1'
WHEN Convert(Int,LASTQCODE) = 184 THEN '1'
WHEN Convert(Int,LASTQCODE) = 185 THEN '1'
WHEN Convert(Int,LASTQCODE) = 186 THEN '1'
WHEN Convert(Int,LASTQCODE) = 189 THEN '1'
WHEN Convert(Int,LASTQCODE) = 190 THEN '1'
WHEN Convert(Int,LASTQCODE) = 192 THEN '1'
WHEN Convert(Int,LASTQCODE) = 193 THEN '1'
WHEN Convert(Int,LASTQCODE) = 194 THEN '1'
WHEN Convert(Int,LASTQCODE) = 195 THEN '1'
WHEN Convert(Int,LASTQCODE) = 196 THEN '1'
WHEN Convert(Int,LASTQCODE) = 197 THEN '1'
WHEN Convert(Int,LASTQCODE) = 198 THEN '1'
WHEN Convert(Int,LASTQCODE) = 199 THEN '1'
WHEN Convert(Int,LASTQCODE) = 200 THEN '1'
WHEN Convert(Int,LASTQCODE) = 201 THEN '1'
WHEN Convert(Int,LASTQCODE) = 202 THEN '1'
WHEN Convert(Int,LASTQCODE) = 203 THEN '1'
WHEN Convert(Int,LASTQCODE) = 204 THEN '1'
WHEN Convert(Int,LASTQCODE) = 205 THEN '1'
WHEN Convert(Int,LASTQCODE) = 206 THEN '1'
WHEN Convert(Int,LASTQCODE) = 207 THEN '1'
WHEN Convert(Int,LASTQCODE) = 208 THEN '1'
WHEN Convert(Int,LASTQCODE) = 210 THEN '1'
WHEN Convert(Int,LASTQCODE) = 211 THEN '1'
WHEN Convert(Int,LASTQCODE) = 212 THEN '1'
WHEN Convert(Int,LASTQCODE) = 214 THEN '1'
WHEN Convert(Int,LASTQCODE) = 217 THEN '1'
WHEN Convert(Int,LASTQCODE) = 0 THEN '0'
WHEN Convert(Int,LASTQCODE) = 1 THEN '0'
WHEN Convert(Int,LASTQCODE) = 2 THEN '0'
WHEN Convert(Int,LASTQCODE) = 4 THEN '0'
WHEN Convert(Int,LASTQCODE) = 5 THEN '0'
WHEN Convert(Int,LASTQCODE) = 6 THEN '0'
WHEN Convert(Int,LASTQCODE) = 9 THEN '1'
WHEN Convert(Int,LASTQCODE) = 20 THEN '0'
WHEN Convert(Int,LASTQCODE) = 21 THEN '0'
WHEN Convert(Int,LASTQCODE) = 80 THEN '0'
WHEN Convert(Int,LASTQCODE) = 81 THEN '0'
WHEN Convert(Int,LASTQCODE) = 82 THEN '0'
WHEN Convert(Int,LASTQCODE) = 83 THEN '0'
WHEN Convert(Int,LASTQCODE) = 84 THEN '0'
WHEN Convert(Int,LASTQCODE) = 85 THEN '0'
WHEN Convert(Int,LASTQCODE) = 90 THEN '1'
WHEN Convert(Int,LASTQCODE) = 91 THEN '1'
WHEN Convert(Int,LASTQCODE) = 92 THEN '1'
WHEN Convert(Int,LASTQCODE) = 93 THEN '1'
WHEN Convert(Int,LASTQCODE) = 94 THEN '1'
WHEN Convert(Int,LASTQCODE) = 95 THEN '0'
WHEN Convert(Int,LASTQCODE) = 96 THEN '1'
WHEN Convert(Int,LASTQCODE) = 97 THEN '0'
WHEN Convert(Int,LASTQCODE) = 98 THEN '1'
ELSE OutboundQCodeByServiceID.DESCRIPTION END AS [Contact Indicator_1],

-----\Commission Type Group-----//

CASE WHEN PREP.PCO_LOAD.DESCRIPTION = 'Vasco_Shopify_Lead' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'OUT VC_Telkom_PreviousSales_UpsellsAug2022toJan2023' THEN 'MIGRATE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_545_A000010545_NOTIFY_OBC_MOBILE_TO_FIBRE_MAGRATION_DEALER_20230609' THEN 'MIGRATE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_546_A000010541_NOTIFY_OBC_LTE_TO_FIBRE_MAGRATION_DEALER_20230609' THEN 'MIGRATE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_548_A000012532__OBC_30DAYS_FIX_COMPLEX_TO_FIBRE_MAGRATION_DEALER_20230622_110418_1' THEN 'MIGRATE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_549_A000012532__OBC_30DAYS_FIX_STANDALONE_TO_FIBRE_MAGRATION_DEALER_20230622_110418_1' THEN 'MIGRATE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_550_A000012532__OBC_30DAYS_MOBILE_COMPLEX_TO_FIBRE_MAGRATION_DEALER_20230622_112736_1' THEN 'MIGRATE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_551_A000012532__OBC_30DAYS_MOBILE_STANDALONE_TO_FIBRE_MAGRATION_DEALER_20230622_112736_1' THEN 'MIGRATE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_552_A000009921_NOTIFY_OBC_DSL_GREY_TO_FIBRE_WINTER_CAMPAIGN' THEN 'MIGRATE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_553_A000009921_NOTIFY_OBC_DSL_TO_FIBRE_WINTER_CAMPAIGN' THEN 'MIGRATE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_554_A000009921_NOTIFY_OBC_FIXEDVOICE_TO_FIBRE_WINTER' THEN 'MIGRATE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '9_547_Target Fibre Areas 2023-06-19' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '9_555_TARGETFIBREAREA_2023-07-18' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_556_NOTIFY_OBC_FTTH_PRE_ORDER_DSL_20230728.csv' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_557_NOTIFY_OBC_FTTH_PRE_ORDER_VOICE_CONGESTED_20230728.csv' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_558_NOTIFY_OBC_FTTH_PRE_ORDER_VOICE_NOT_CONGESTED_20230728' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_559_A000010541_OBC_LTE_TO_FIBRE_MAGRATION_26_jul_2023' THEN 'MIGRATE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_560_A000010545_NOTIFY_OBC_MOBILE_TO_FIBRE_MAGRATION_MAGRATION_26_jul_2023' THEN 'MIGRATE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_561_Openserve Project Phakisa Campaign' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_562_Openserve Project Phakisa Mobile Data Campaign' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '9_563_TargetFibreAreas_2023-08-25' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_564_Telkom TBYB' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_565_Telkom Leads' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'CLI TEST' THEN 'TEST'
WHEN PREP.PCO_LOAD.DESCRIPTION = '9_566_Fibre_PROXIMITY_2023-09-20' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_568_WEB_CONNECT_AREAS_2023-09-13_3' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'Telkom_PreviousSales_UpsellsFeb2023ToMay2023' THEN 'UPSELL'
WHEN PREP.PCO_LOAD.DESCRIPTION = '9_569_2023-10-23 Openserve Latest' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '9_570_2023-10-23 Target Fibre Areas_1' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '9_571_2023-10-23 Target Fibre Areas_2' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'SocialMedia_FacebookLiveList' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_574_A000020824_NOTIFY_OBC_MOBILE_TO_FIBRE_MAGRATION_BLACK_FIDAY_2023' THEN 'UPSELL'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'Upsells_KribsList_07122023' THEN 'UPSELL'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'Telkom_Big Deal Leads' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'Telkom_Clevva Leads' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_573_A000020824_OBC_LTE_TO_FIBRE_MAGRATION_BLACK_FRIDAY_2023_50AndOver' THEN 'UPSELL'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_573_A000020824_OBC_LTE_TO_FIBRE_MAGRATION_BLACK_FRIDAY_2023_LessThan50' THEN 'UPSELL'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'DecolloLiveList' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_577_A000020977_NOTIFY_OBC_DSL_TO_FIBRE_JAN_PROMO' THEN 'MIGRATE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_578_A000020977_NOTIFY_OBC_DSL_GREY_TO_FIBRE_JAN_PROMO' THEN 'MIGRATE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_579_A000020977_NOTIFY_OBC_FIXED_VOICE_TO_FIBRE_JAN_PROMO' THEN 'MIGRATE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_580_Online fixed line unreachable - 01-16 February 2024' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'NOTIFY_OBC_DSL_TO_FIBRE_2024_03_26' THEN 'MIGRATE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_581_A000009921_NOTIFY_OBC_DSL_GREY_TO_FIBRE_2024_03_26' THEN 'MIGRATE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_583_A000009921_NOTIFY_OBC_FIXED_VOICE_TO_FIBRE_2024_03_26' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'Online fixed line unreachable_16Feb-16 March 2024_08' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '20240418 Core 20mbps' THEN 'UPSELL'
WHEN PREP.PCO_LOAD.DESCRIPTION = '20240418 150mbps' THEN 'UPSELL'
WHEN PREP.PCO_LOAD.DESCRIPTION = '20240418_Fixed_20mbps' THEN 'UPSELL'
WHEN PREP.PCO_LOAD.DESCRIPTION = '20240419 END150150 (a)' THEN 'UPSELL'
WHEN PREP.PCO_LOAD.DESCRIPTION = '20240419 END50mbps (a)' THEN 'UPSELL'
WHEN PREP.PCO_LOAD.DESCRIPTION = '20240424 Core 100mbps' THEN 'UPSELL'
WHEN PREP.PCO_LOAD.DESCRIPTION = '20240424 End 100mbps' THEN 'UPSELL'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'Upsell Jan-April 20240426' THEN 'UPSELL'
WHEN PREP.PCO_LOAD.DESCRIPTION = '20240429_Infraustruture_Internal_List' THEN 'UPSELL'
WHEN PREP.PCO_LOAD.DESCRIPTION = '2024-04-30 No Infrastructure Winback_Presence' THEN 'UPSELL'
WHEN PREP.PCO_LOAD.DESCRIPTION = '2024-05-03_Cancelled_Orders_Jan2023_to_April2023_Internal_ListView' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '2024-05-03_Upsells_Jan2023_to_April2023_Internal_List_ExportView' THEN 'UPSELL'
WHEN PREP.PCO_LOAD.DESCRIPTION = '2024-05-14_Upsells_Cancelled_Orders_Oct_2023_Internal_List_ExportView' THEN 'UPSELL'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'Online fixed line unreachable - (1 - 15 April 2024) 20240514' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'A000009921_NOTIFY_OBC_DSL_GREY_TO_FIBRE.csv' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'A000009921_NOTIFY_OBC_DSL_TO_FIBRE.csv' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'A000009921_NOTIFY_OBC_FIXED_VOICE_TO_FIBRE.csv' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '9_407_2022-08-20_POF_INTERIOR' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'test' THEN 'TEST'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'Online fixed line unreachable - 1 - 15 May 2024' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '2024-06-25_NTF_Cancelled_Aug2023_to_Nov2023_Internal_List_ExportView' THEN 'NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '2024-07-04_NTF_Completed_Orders_Internal_List' THEN 'NTF'
ELSE OutboundQCodeByServiceID.DESCRIPTION END AS [Commision Type],

CASE WHEN PREP.PCO_LOAD.DESCRIPTION = 'Vasco_Shopify_Lead' THEN 'Vasco_Shopify_Lead'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'OUT VC_Telkom_PreviousSales_UpsellsAug2022toJan2023' THEN 'Internal_Upsell'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_545_A000010545_NOTIFY_OBC_MOBILE_TO_FIBRE_MAGRATION_DEALER_20230609' THEN 'MIGRATION MOBILE TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_546_A000010541_NOTIFY_OBC_LTE_TO_FIBRE_MAGRATION_DEALER_20230609' THEN 'MIGRATION LTE TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_548_A000012532__OBC_30DAYS_FIX_COMPLEX_TO_FIBRE_MAGRATION_DEALER_20230622_110418_1' THEN 'MIGRATION 30 DAYS FIX COMPLEX TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_549_A000012532__OBC_30DAYS_FIX_STANDALONE_TO_FIBRE_MAGRATION_DEALER_20230622_110418_1' THEN 'MIGRATION 30 DAYS FIX STANDALONE TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_550_A000012532__OBC_30DAYS_MOBILE_COMPLEX_TO_FIBRE_MAGRATION_DEALER_20230622_112736_1' THEN 'MIGRATION 30 DAYS MOBILE COMPLEX TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_551_A000012532__OBC_30DAYS_MOBILE_STANDALONE_TO_FIBRE_MAGRATION_DEALER_20230622_112736_1' THEN 'MIGRATION 30 DAYS MOBILE STANDALONE TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_552_A000009921_NOTIFY_OBC_DSL_GREY_TO_FIBRE_WINTER_CAMPAIGN' THEN 'DSL GREY TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_553_A000009921_NOTIFY_OBC_DSL_TO_FIBRE_WINTER_CAMPAIGN' THEN 'DSL TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_554_A000009921_NOTIFY_OBC_FIXEDVOICE_TO_FIBRE_WINTER' THEN 'FIXEDVOICE TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '9_547_Target Fibre Areas 2023-06-19' THEN 'TARGET FIBRE AREAS'
WHEN PREP.PCO_LOAD.DESCRIPTION = '9_555_TARGETFIBREAREA_2023-07-18' THEN 'TARGET FIBRE AREAS'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_556_NOTIFY_OBC_FTTH_PRE_ORDER_DSL_20230728.csv' THEN 'PREORDER DSL'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_557_NOTIFY_OBC_FTTH_PRE_ORDER_VOICE_CONGESTED_20230728.csv' THEN 'PREORDER VOICE CONGESTED'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_558_NOTIFY_OBC_FTTH_PRE_ORDER_VOICE_NOT_CONGESTED_20230728' THEN 'PREORDER VOICE NOT CONGESTED'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_559_A000010541_OBC_LTE_TO_FIBRE_MAGRATION_26_jul_2023' THEN 'MIGRATION LTE TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_560_A000010545_NOTIFY_OBC_MOBILE_TO_FIBRE_MAGRATION_MAGRATION_26_jul_2023' THEN 'MIGRATION MOBILE TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_561_Openserve Project Phakisa Campaign' THEN 'PROJECT PHAKISA'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_562_Openserve Project Phakisa Mobile Data Campaign' THEN 'PROJECT PHAKISA'
WHEN PREP.PCO_LOAD.DESCRIPTION = '9_563_TargetFibreAreas_2023-08-25' THEN 'TARGET FIBRE AREAS'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_564_Telkom TBYB' THEN 'Try Before you Buy'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_565_Telkom Leads' THEN 'TELKOM LEADS'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'CLI TEST' THEN 'TEST'
WHEN PREP.PCO_LOAD.DESCRIPTION = '9_566_Fibre_PROXIMITY_2023-09-20' THEN 'TARGET FIBRE AREAS'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_568_WEB_CONNECT_AREAS_2023-09-13_3' THEN 'TARGET FIBRE AREAS'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'Telkom_PreviousSales_UpsellsFeb2023ToMay2023' THEN 'Internal_Upsell'
WHEN PREP.PCO_LOAD.DESCRIPTION = '9_569_2023-10-23 Openserve Latest' THEN 'TARGET FIBRE AREAS'
WHEN PREP.PCO_LOAD.DESCRIPTION = '9_570_2023-10-23 Target Fibre Areas_1' THEN 'TARGET FIBRE AREAS'
WHEN PREP.PCO_LOAD.DESCRIPTION = '9_571_2023-10-23 Target Fibre Areas_2' THEN 'TARGET FIBRE AREAS'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'SocialMedia_FacebookLiveList' THEN 'FaceBook Fibre Data'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_574_A000020824_NOTIFY_OBC_MOBILE_TO_FIBRE_MAGRATION_BLACK_FIDAY_2023' THEN 'MIGRATION MOBILE TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'Upsells_KribsList_07122023' THEN 'Internal_Upsell'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'Telkom_Big Deal Leads' THEN 'Telkom_Big Deal Leads'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'Telkom_Clevva Leads' THEN 'Telkom_Clevva Leads'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_573_A000020824_OBC_LTE_TO_FIBRE_MAGRATION_BLACK_FRIDAY_2023_50AndOver' THEN 'MIGRATION LTE TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_573_A000020824_OBC_LTE_TO_FIBRE_MAGRATION_BLACK_FRIDAY_2023_LessThan50' THEN 'MIGRATION LTE TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'DecolloLiveList' THEN 'DECOLLO'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_577_A000020977_NOTIFY_OBC_DSL_TO_FIBRE_JAN_PROMO' THEN 'DSL TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_578_A000020977_NOTIFY_OBC_DSL_GREY_TO_FIBRE_JAN_PROMO' THEN 'DSL GREY TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_579_A000020977_NOTIFY_OBC_FIXED_VOICE_TO_FIBRE_JAN_PROMO' THEN 'FIXEDVOICE TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_580_Online fixed line unreachable - 01-16 February 2024' THEN 'Online Unreachable'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'NOTIFY_OBC_DSL_TO_FIBRE_2024_03_26' THEN 'DSL TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_581_A000009921_NOTIFY_OBC_DSL_GREY_TO_FIBRE_2024_03_26' THEN 'DSL GREY TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '3_583_A000009921_NOTIFY_OBC_FIXED_VOICE_TO_FIBRE_2024_03_26' THEN 'FIXEDVOICE TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'Online fixed line unreachable_16Feb-16 March 2024_08' THEN 'Online Unreachable'
WHEN PREP.PCO_LOAD.DESCRIPTION = '20240418 Core 20mbps' THEN 'Internal_Upsell'
WHEN PREP.PCO_LOAD.DESCRIPTION = '20240418 150mbps' THEN 'Internal_Upsell'
WHEN PREP.PCO_LOAD.DESCRIPTION = '20240418_Fixed_20mbps' THEN 'Internal_Upsell'
WHEN PREP.PCO_LOAD.DESCRIPTION = '20240419 END150150 (a)' THEN 'Internal_Upsell'
WHEN PREP.PCO_LOAD.DESCRIPTION = '20240419 END50mbps (a)' THEN 'Internal_Upsell'
WHEN PREP.PCO_LOAD.DESCRIPTION = '20240424 Core 100mbps' THEN 'Internal_Upsell'
WHEN PREP.PCO_LOAD.DESCRIPTION = '20240424 End 100mbps' THEN 'Internal_Upsell'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'Upsell Jan-April 20240426' THEN 'Internal_Upsell'
WHEN PREP.PCO_LOAD.DESCRIPTION = '20240429_Infraustruture_Internal_List' THEN 'Internal_Upsell'
WHEN PREP.PCO_LOAD.DESCRIPTION = '2024-04-30 No Infrastructure Winback_Presence' THEN 'Internal_Upsell'
WHEN PREP.PCO_LOAD.DESCRIPTION = '2024-05-03_Cancelled_Orders_Jan2023_to_April2023_Internal_ListView' THEN 'Internal_NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '2024-05-03_Upsells_Jan2023_to_April2023_Internal_List_ExportView' THEN 'Internal_Upsell'
WHEN PREP.PCO_LOAD.DESCRIPTION = '2024-05-14_Upsells_Cancelled_Orders_Oct_2023_Internal_List_ExportView' THEN 'Internal_Upsell'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'Online fixed line unreachable - (1 - 15 April 2024) 20240514' THEN 'Online Unreachable'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'A000009921_NOTIFY_OBC_DSL_GREY_TO_FIBRE.csv' THEN 'DSL TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'A000009921_NOTIFY_OBC_DSL_TO_FIBRE.csv' THEN 'DSL GREY TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'A000009921_NOTIFY_OBC_FIXED_VOICE_TO_FIBRE.csv' THEN 'FIXEDVOICE TO FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = '9_407_2022-08-20_POF_INTERIOR' THEN 'PREORDER FIBRE'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'test' THEN 'TEST'
WHEN PREP.PCO_LOAD.DESCRIPTION = 'Online fixed line unreachable - 1 - 15 May 2024' THEN 'Online Unreachable'
WHEN PREP.PCO_LOAD.DESCRIPTION = '2024-06-25_NTF_Cancelled_Aug2023_to_Nov2023_Internal_List_ExportView' THEN 'Internal_NTF'
WHEN PREP.PCO_LOAD.DESCRIPTION = '2024-07-04_NTF_Completed_Orders_Internal_List' THEN 'Internal_NTF'
ELSE PREP.PCO_LOAD.DESCRIPTION END AS [Load Description],
COUNT (*) as [Total Dials],
PREP.PCO_OUTBOUNDQUEUE.DAILYCOUNTER,
PREP.PCO_OUTBOUNDQUEUE.TOTALCOUNTER,
PREP.PCO_OUTBOUNDQUEUE.BUSYSIGNALCOUNTER,
PREP.PCO_OUTBOUNDQUEUE.NOANSWERCOUNTER,
PREP.PCO_OUTBOUNDQUEUE.ANSWERMACHINECOUNTER,
PREP.PCO_OUTBOUNDQUEUE.FAXCOUNTER,
PREP.PCO_OUTBOUNDQUEUE.INVGENREASONCOUNTER,
PREP.PCO_OUTBOUNDQUEUE.PRIORITY,
PREP.PCO_OUTBOUNDQUEUE.CAPTURINGAGENT,
PREP.PCO_OUTBOUNDQUEUE.COMMENTS
FROM   dbo.StatusCodes
INNER JOIN PREP.PCO_OUTBOUNDQUEUE ON dbo.StatusCodes.StatusId = PREP.PCO_OUTBOUNDQUEUE.STATUS
LEFT JOIN PREP.PCO_OUTBOUNDLOG ON PREP.PCO_OUTBOUNDQUEUE.ID = PREP.PCO_OUTBOUNDLOG.OUTBOUNDQUEUEID
LEFT OUTER JOIN PREP.PCO_AGENT
INNER JOIN PREP.PCO_LOGINAGENT ON PREP.PCO_AGENT.ID = PREP.PCO_LOGINAGENT.AGENTID ON PREP.PCO_OUTBOUNDQUEUE.LASTAGENT = PREP.PCO_LOGINAGENT.LOGIN 
LEFT OUTER JOIN PREP.PCO_LOAD ON PREP.PCO_OUTBOUNDQUEUE.LOADID = PREP.PCO_LOAD.LOADID AND PREP.PCO_OUTBOUNDQUEUE.SERVICEID = PREP.PCO_LOAD.SERVICEID 
LEFT OUTER JOIN PREP.PCO_OUTBOUNDSERVICE ON PREP.PCO_OUTBOUNDQUEUE.SERVICEID = PREP.PCO_OUTBOUNDSERVICE.ID 
LEFT OUTER JOIN dbo.OutboundQCodeByServiceID ON PREP.PCO_OUTBOUNDQUEUE.SERVICEID = dbo.OutboundQCodeByServiceID.SERVICEID AND PREP.PCO_OUTBOUNDQUEUE.LASTQCODE = dbo.OutboundQCodeByServiceID.QCODE
WHERE PREP.PCO_OUTBOUNDQUEUE.SERVICEID in (1101, 1111, 1110, 1112, 1127, 1128, 1130, 1133, 1134, 1135, 1137, 1138, 1123, 1129, 1131, 1132, 1136) and
PREP.PCO_OUTBOUNDQUEUE.RDATE >= '2023-06-01 00:00:00'
GROUP BY PREP.PCO_OUTBOUNDQUEUE.SOURCEID, PREP.PCO_OUTBOUNDQUEUE.ID, PREP.PCO_OUTBOUNDQUEUE.SERVICEID, PREP.PCO_OUTBOUNDSERVICE.NAME, PREP.PCO_OUTBOUNDQUEUE.NAME, PREP.PCO_OUTBOUNDQUEUE.PHONE, dbo.StatusCodes.DESCRIPTION,
PREP.PCO_OUTBOUNDQUEUE.SCHEDULEDATE, PREP.PCO_OUTBOUNDQUEUE.LOADID, PREP.PCO_LOAD.DESCRIPTION, PREP.PCO_OUTBOUNDQUEUE.LASTAGENT, PREP.PCO_AGENT.NAME, Convert(date,PREP.PCO_OUTBOUNDQUEUE.RDATE), Convert(date,PREP.PCO_OUTBOUNDQUEUE.FIRSTHANDLINGDATE),
PREP.PCO_OUTBOUNDQUEUE.DAILYCOUNTER, PREP.PCO_OUTBOUNDQUEUE.TOTALCOUNTER, PREP.PCO_OUTBOUNDQUEUE.BUSYSIGNALCOUNTER, PREP.PCO_OUTBOUNDQUEUE.NOANSWERCOUNTER, PREP.PCO_OUTBOUNDQUEUE.ANSWERMACHINECOUNTER, PREP.PCO_OUTBOUNDQUEUE.FAXCOUNTER,
PREP.PCO_OUTBOUNDQUEUE.INVGENREASONCOUNTER, PREP.PCO_OUTBOUNDQUEUE.PRIORITY, PREP.PCO_OUTBOUNDQUEUE.CAPTURINGAGENT, PREP.PCO_OUTBOUNDQUEUE.COMMENTS, dbo.OutboundQCodeByServiceID.CATEGORY, LASTQCODE, OutboundQCodeByServiceID.DESCRIPTION,
Convert(Date,PREP.PCO_OUTBOUNDQUEUE.LASTHANDLINGDATE)
ORDER BY SOURCEID
